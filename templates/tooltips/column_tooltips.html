{% macro tooltip_header(header_text, tooltip_type, tab_id='all') %}
    {% set tooltip_id = tab_id ~ '-' ~ tooltip_type %}
    <th>
        <div class="header-with-tooltip">
            {{ header_text }}
            <span class="info-icon" onmouseover="showTooltip('{{ tooltip_id }}')"
                  onmouseout="hideTooltip('{{ tooltip_id }}')">
                <i class="fas fa-info-circle"></i>
                <div id="{{ tooltip_id }}" class="tooltip-content">
                    {% if tooltip_type == 'rpki-tooltip' %}
                        <h4>Resource Public Key Infrastructure (RPKI)</h4>
                        <p>RPKI is a security framework that verifies IP address ownership and ensures proper routing.</p>
                        <ul>
                            <li>Prevents BGP hijacking and route leaks</li>
                            <li>Validates that IP prefixes are announced by authorized networks</li>
                            <li>Improves overall internet routing security</li>
                        </ul>
                    {% elif tooltip_type == 'dane-tooltip' %}
                        <h4>DNS-based Authentication of Named Entities (DANE)</h4>
                        <p>DANE binds TLS certificates to domains using DNSSEC, providing an additional layer of validation.</p>
                        <ul>
                            <li>Reduces reliance on traditional certificate authorities</li>
                            <li>Helps prevent man-in-the-middle attacks</li>
                            <li>Enables stronger verification of encrypted connections</li>
                        </ul>
                    {% elif tooltip_type == 'dnssec-tooltip' %}
                        <h4>Domain Name System Security Extensions (DNSSEC)</h4>
                        <p>DNSSEC adds cryptographic signatures to DNS records to ensure their authenticity.</p>
                        <ul>
                            <li>Protects against DNS cache poisoning</li>
                            <li>Verifies DNS responses come from legitimate sources</li>
                            <li>Provides a chain of trust from the root zone to subdomains</li>
                        </ul>
                    {% elif tooltip_type == 'dnssec-security-tooltip' %}
                        <h4>DNSSEC Security Assessment</h4>
                        <p>In-depth security analysis of DNSSEC implementation beyond basic compliance.</p>
                        <ul>
                            <li><strong>Secure:</strong> No vulnerabilities detected</li>
                            <li><strong>Low/Medium:</strong> Minor to moderate security issues</li>
                            <li><strong>High/Critical:</strong> Serious vulnerabilities that require immediate attention</li>
                        </ul>
                        <p>This assessment evaluates NSEC3 parameters, key material strength, signature timing, and cryptographic implementation.</p>
                    {% elif tooltip_type == 'email-security-tooltip' %}
                        <h4>Email Security Standards</h4>
                        <p>A combination of protocols that protect email from spoofing and phishing.</p>
                        <ul>
                            <li><strong>SPF:</strong> Specifies which servers can send email from your domain</li>
                            <li><strong>DKIM:</strong> Digitally signs emails to verify they haven't been tampered with.</li>
                            <li><strong>DMARC:</strong> Policies for handling emails that fail SPF or DKIM checks</li>
                        </ul>
                    {% elif tooltip_type == 'web-security-tooltip' %}
                        <h4>WEB Security</h4>
                        <p>Transport Layer Security (TLS) is a protocol that ensures privacy between communicating applications and their users on the Internet.</p>
                        <p>This check evaluates:</p>
                        <ul>
                            <li><strong>Certificate validity</strong> - Is the SSL/TLS certificate valid and from a trusted authority?</li>
                            <li><strong>Protocol security</strong> - Are only secure TLS versions supported?</li>
                            <li><strong>Cipher strength</strong> - Are strong encryption ciphers used?</li>
                            <li><strong>Security headers</strong> - Are essential security HTTP headers implemented?</li>
                            <li><strong>HSTS</strong> - Is HTTP Strict Transport Security properly configured?</li>
                        </ul>
                        <p>The overall rating summarizes the security posture of the site's TLS implementation.</p>
                    {% endif %}
                </div>
            </span>
        </div>
    </th>
{% endmacro %}